{
    "Conditions": {
        "GovCloudCondition": {
            "Fn::Equals": [
                {
                    "Ref": "AWS::Region"
                },
                "us-gov-west-1"
            ]
        },
        "NumInstancesLessThanOrEqualTo10": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        10
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo9"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo11": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        11
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo10"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo12": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        12
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo11"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo13": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        13
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo12"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo14": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        14
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo13"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo15": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        15
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo14"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo16": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        16
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo15"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo17": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        17
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo16"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo18": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        18
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo17"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo19": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        19
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo18"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo20": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        20
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo19"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo21": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        21
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo20"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo22": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        22
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo21"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo23": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        23
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo22"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo24": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        24
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo23"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo25": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        25
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo24"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo26": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        26
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo25"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo27": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        27
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo26"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo28": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        28
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo27"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo29": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        29
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo28"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo4": {
            "Fn::Equals": [
                {
                    "Ref": "NumSRRHosts"
                },
                4
            ]
        },
        "NumInstancesLessThanOrEqualTo5": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        5
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo4"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo6": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        6
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo5"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo7": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        7
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo6"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo8": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        8
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo7"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo9": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        9
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo8"
                }
            ]
        }
    },
    "Mappings": {
        "AWSAMIRegion": {
            "us-west-2": {
                "AMI": "ami-9b3f23e2"
            }
        }
    },
    "Outputs": {
        "ElasticLoadBalancerID": {
            "Description": "ElasticLoadBalancerID ID",
            "Value": {
                "Ref": "ElasticLoadBalancer"
            }
        },
        "StorReduceInstance0PrivateDNS": {
            "Description": "StorReduceInstance0 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance0",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance0PrivateIp": {
            "Description": "StorReduceInstance0 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance0",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance10PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo11",
            "Description": "StorReduceInstance10 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance10",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance10PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo11",
            "Description": "StorReduceInstance10 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance10",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance11PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo12",
            "Description": "StorReduceInstance11 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance11",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance11PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo12",
            "Description": "StorReduceInstance11 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance11",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance12PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo13",
            "Description": "StorReduceInstance12 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance12",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance12PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo13",
            "Description": "StorReduceInstance12 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance12",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance13PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo14",
            "Description": "StorReduceInstance13 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance13",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance13PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo14",
            "Description": "StorReduceInstance13 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance13",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance14PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo15",
            "Description": "StorReduceInstance14 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance14",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance14PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo15",
            "Description": "StorReduceInstance14 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance14",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance15PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo16",
            "Description": "StorReduceInstance15 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance15",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance15PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo16",
            "Description": "StorReduceInstance15 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance15",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance16PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo17",
            "Description": "StorReduceInstance16 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance16",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance16PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo17",
            "Description": "StorReduceInstance16 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance16",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance17PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo18",
            "Description": "StorReduceInstance17 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance17",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance17PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo18",
            "Description": "StorReduceInstance17 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance17",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance18PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo19",
            "Description": "StorReduceInstance18 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance18",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance18PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo19",
            "Description": "StorReduceInstance18 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance18",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance19PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo20",
            "Description": "StorReduceInstance19 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance19",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance19PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo20",
            "Description": "StorReduceInstance19 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance19",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance1PrivateDNS": {
            "Description": "StorReduceInstance1 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance1",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance1PrivateIp": {
            "Description": "StorReduceInstance1 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance1",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance20PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo21",
            "Description": "StorReduceInstance20 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance20",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance20PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo21",
            "Description": "StorReduceInstance20 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance20",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance21PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo22",
            "Description": "StorReduceInstance21 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance21",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance21PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo22",
            "Description": "StorReduceInstance21 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance21",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance22PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo23",
            "Description": "StorReduceInstance22 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance22",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance22PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo23",
            "Description": "StorReduceInstance22 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance22",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance23PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo24",
            "Description": "StorReduceInstance23 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance23",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance23PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo24",
            "Description": "StorReduceInstance23 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance23",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance24PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo25",
            "Description": "StorReduceInstance24 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance24",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance24PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo25",
            "Description": "StorReduceInstance24 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance24",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance25PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo26",
            "Description": "StorReduceInstance25 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance25",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance25PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo26",
            "Description": "StorReduceInstance25 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance25",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance26PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo27",
            "Description": "StorReduceInstance26 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance26",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance26PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo27",
            "Description": "StorReduceInstance26 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance26",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance27PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo28",
            "Description": "StorReduceInstance27 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance27",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance27PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo28",
            "Description": "StorReduceInstance27 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance27",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance28PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo29",
            "Description": "StorReduceInstance28 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance28",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance28PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo29",
            "Description": "StorReduceInstance28 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance28",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance2PrivateDNS": {
            "Description": "StorReduceInstance2 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance2",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance2PrivateIp": {
            "Description": "StorReduceInstance2 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance2",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance3PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo4",
            "Description": "StorReduceInstance3 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance3",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance3PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo4",
            "Description": "StorReduceInstance3 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance3",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance4PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo5",
            "Description": "StorReduceInstance4 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance4",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance4PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo5",
            "Description": "StorReduceInstance4 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance4",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance5PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo6",
            "Description": "StorReduceInstance5 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance5",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance5PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo6",
            "Description": "StorReduceInstance5 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance5",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance6PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo7",
            "Description": "StorReduceInstance6 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance6",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance6PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo7",
            "Description": "StorReduceInstance6 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance6",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance7PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo8",
            "Description": "StorReduceInstance7 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance7",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance7PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo8",
            "Description": "StorReduceInstance7 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance7",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance8PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo9",
            "Description": "StorReduceInstance8 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance8",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance8PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo9",
            "Description": "StorReduceInstance8 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance8",
                    "PrivateIp"
                ]
            }
        },
        "StorReduceInstance9PrivateDNS": {
            "Condition": "NumInstancesLessThanOrEqualTo10",
            "Description": "StorReduceInstance9 Private DNS",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance9",
                    "PrivateDnsName"
                ]
            }
        },
        "StorReduceInstance9PrivateIp": {
            "Condition": "NumInstancesLessThanOrEqualTo10",
            "Description": "StorReduceInstance9 Private IP",
            "Value": {
                "Fn::GetAtt": [
                    "StorReduceInstance9",
                    "PrivateIp"
                ]
            }
        }
    },
    "Parameters": {
        "AvailabilityZones": {
            "Description": "The availability zone in which to place the EC2 instance",
            "Type": "List<AWS::EC2::AvailabilityZone::Name>"
        },
        "BucketName": {
            "ConstraintDescription": "must be a valid S3 bucket name.",
            "Description": "The bucket to which StorReduce will store data",
            "Type": "String"
        },
        "HostProfile": {
            "Description": "The host profile to associate with the StorReduce instance(s)",
            "Type": "String"
        },
        "HostRole": {
            "Description": "The host role to associate with the StorReduce instance(s) for pulling scripts",
            "Type": "String"
        },
        "InstanceType": {
            "AllowedValues": [
                "t1.micro",
                "t2.nano",
                "t2.micro",
                "t2.small",
                "t2.medium",
                "t2.large",
                "m1.small",
                "m1.medium",
                "m1.large",
                "m1.xlarge",
                "m2.xlarge",
                "m2.2xlarge",
                "m2.4xlarge",
                "m3.medium",
                "m3.large",
                "m3.xlarge",
                "m3.2xlarge",
                "m4.large",
                "m4.xlarge",
                "m4.2xlarge",
                "m4.4xlarge",
                "m4.10xlarge",
                "c1.medium",
                "c1.xlarge",
                "c3.large",
                "c3.xlarge",
                "c3.2xlarge",
                "c3.4xlarge",
                "c3.8xlarge",
                "c4.large",
                "c4.xlarge",
                "c4.2xlarge",
                "c4.4xlarge",
                "c4.8xlarge",
                "g2.2xlarge",
                "g2.8xlarge",
                "r3.large",
                "r3.xlarge",
                "r3.2xlarge",
                "r3.4xlarge",
                "r3.8xlarge",
                "i2.xlarge",
                "i2.2xlarge",
                "i2.4xlarge",
                "i2.8xlarge",
                "d2.xlarge",
                "d2.2xlarge",
                "d2.4xlarge",
                "d2.8xlarge",
                "hi1.4xlarge",
                "hs1.8xlarge",
                "cr1.8xlarge",
                "cc2.8xlarge",
                "cg1.4xlarge"
            ],
            "ConstraintDescription": "must be a valid EC2 instance type.",
            "Default": "c3.large",
            "Description": "EC2 instance type",
            "Type": "String"
        },
        "KeyPairName": {
            "ConstraintDescription": "must be the name of an existing EC2 KeyPair.",
            "Description": "Name of an existing EC2 KeyPair to enable SSH access to the instances",
            "Type": "AWS::EC2::KeyPair::KeyName"
        },
        "LoadBalancerSecurityGroup": {
            "Description": "The security group associated with the load balancer",
            "Type": "AWS::EC2::SecurityGroup::Id"
        },
        "NumSRRHosts": {
            "Description": "The number of StorReduce hosts to configure",
            "MaxValue": 29,
            "MinValue": 3,
            "Type": "Number"
        },
        "PrivateSubnetsToSpan": {
            "Description": "The VPC private subnets to span",
            "Type": "List<AWS::EC2::Subnet::Id>"
        },
        "PublicSubnetsToSpan": {
            "Description": "The VPC public subnets to span",
            "Type": "List<AWS::EC2::Subnet::Id>"
        },
        "QSS3BucketName": {
            "AllowedPattern": "^[0-9a-zA-Z]+([0-9a-zA-Z-]*[0-9a-zA-Z])*$",
            "ConstraintDescription": "Quick Start bucket name can include numbers, lowercase letters, uppercase letters, and hyphens (-). It cannot start or end with a hyphen (-).",
            "Default": "gong-cf-templates",
            "Description": "S3 bucket name for the Quick Start assets. Quick Start bucket name can include numbers, lowercase letters, uppercase letters, and hyphens (-). It cannot start or end with a hyphen (-).",
            "Type": "String"
        },
        "QSS3KeyPrefix": {
            "AllowedPattern": "^[0-9a-zA-Z-/]*$",
            "ConstraintDescription": "Quick Start key prefix can include numbers, lowercase letters, uppercase letters, hyphens (-), and forward slash (/).",
            "Default": "",
            "Description": "S3 key prefix for the Quick Start assets. Quick Start key prefix can include numbers, lowercase letters, uppercase letters, hyphens (-), and forward slash (/).",
            "Type": "String"
        },
        "SSLCertificateId": {
            "Description": "The SSL Certificate ID to use for the load balancer",
            "Type": "String"
        },
        "SecurityGroupIds": {
            "Description": "The securitys group associated with the instance",
            "Type": "List<AWS::EC2::SecurityGroup::Id>"
        },
        "StorReduceLicense": {
            "ConstraintDescription": "must be a current and valid StorReduce license.",
            "Description": "A StorReduce license",
            "Type": "String"
        }
    },
    "Resources": {
        "ElasticLoadBalancer": {
            "Properties": {
                "CrossZone": "true",
                "HealthCheck": {
                    "HealthyThreshold": "3",
                    "Interval": "30",
                    "Target": "HTTP:80/health_check",
                    "Timeout": "5",
                    "UnhealthyThreshold": "5"
                },
                "Listeners": [
                    {
                        "InstancePort": "80",
                        "InstanceProtocol": "TCP",
                        "LoadBalancerPort": "80",
                        "Protocol": "TCP"
                    },
                    {
                        "InstancePort": "443",
                        "InstanceProtocol": "TCP",
                        "LoadBalancerPort": "443",
                        "Protocol": "TCP",
                        "SSLCertificateId": {
                            "Ref": "SSLCertificateId"
                        }
                    }
                ],
                "SecurityGroups": [
                    {
                        "Ref": "LoadBalancerSecurityGroup"
                    }
                ],
                "Subnets": {
                    "Ref": "PublicSubnetsToSpan"
                }
            },
            "Type": "AWS::ElasticLoadBalancing::LoadBalancer"
        },
        "StorReduceInstance0": {
            "DependsOn": "ElasticLoadBalancer",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "init-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo      echo test > /home/ec2-user/test.txt && /home/ec2-user/init-srr.sh \"",
                                            {
                                                "Ref": "BucketName"
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReduceLicense"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Fn::GetAtt": [
                                                    "ElasticLoadBalancer",
                                                    "DNSName"
                                                ]
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/init-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/init-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrBaseHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance0 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance1": {
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance1 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance10": {
            "Condition": "NumInstancesLessThanOrEqualTo11",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance10 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance11": {
            "Condition": "NumInstancesLessThanOrEqualTo12",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance11 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance12": {
            "Condition": "NumInstancesLessThanOrEqualTo13",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance12 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance13": {
            "Condition": "NumInstancesLessThanOrEqualTo14",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance13 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance14": {
            "Condition": "NumInstancesLessThanOrEqualTo15",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance14 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance15": {
            "Condition": "NumInstancesLessThanOrEqualTo16",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance15 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance16": {
            "Condition": "NumInstancesLessThanOrEqualTo17",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance16 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance17": {
            "Condition": "NumInstancesLessThanOrEqualTo18",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance17 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance18": {
            "Condition": "NumInstancesLessThanOrEqualTo19",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance18 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance19": {
            "Condition": "NumInstancesLessThanOrEqualTo20",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance19 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance2": {
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance2 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance20": {
            "Condition": "NumInstancesLessThanOrEqualTo21",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance20 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance21": {
            "Condition": "NumInstancesLessThanOrEqualTo22",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance21 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance22": {
            "Condition": "NumInstancesLessThanOrEqualTo23",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance22 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance23": {
            "Condition": "NumInstancesLessThanOrEqualTo24",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance23 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance24": {
            "Condition": "NumInstancesLessThanOrEqualTo25",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance24 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance25": {
            "Condition": "NumInstancesLessThanOrEqualTo26",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance25 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance26": {
            "Condition": "NumInstancesLessThanOrEqualTo27",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance26 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance27": {
            "Condition": "NumInstancesLessThanOrEqualTo28",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance27 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance28": {
            "Condition": "NumInstancesLessThanOrEqualTo29",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance28 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance3": {
            "Condition": "NumInstancesLessThanOrEqualTo4",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance3 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance4": {
            "Condition": "NumInstancesLessThanOrEqualTo5",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance4 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance5": {
            "Condition": "NumInstancesLessThanOrEqualTo6",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance5 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance6": {
            "Condition": "NumInstancesLessThanOrEqualTo7",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance6 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance7": {
            "Condition": "NumInstancesLessThanOrEqualTo8",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance7 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance8": {
            "Condition": "NumInstancesLessThanOrEqualTo9",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance8 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance9": {
            "Condition": "NumInstancesLessThanOrEqualTo10",
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "echo test > /home/ec2-user/test.txt && /home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" \"",
                                            {
                                                "Ref": "StorReduceInstance0"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" ",
                                            " > output.txt 2>&1"
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance9 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        }
    }
}
