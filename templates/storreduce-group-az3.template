{
    "Conditions": {
        "GovCloudCondition": {
            "Fn::Equals": [
                {
                    "Ref": "AWS::Region"
                },
                "us-gov-west-1"
            ]
        },
        "NumInstancesLessThanOrEqualTo10": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        10
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo9"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo11": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        11
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo10"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo12": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        12
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo11"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo13": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        13
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo12"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo14": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        14
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo13"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo15": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        15
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo14"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo16": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        16
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo15"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo17": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        17
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo16"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo18": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        18
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo17"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo19": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        19
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo18"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo20": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        20
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo19"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo21": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        21
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo20"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo22": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        22
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo21"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo23": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        23
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo22"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo24": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        24
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo23"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo25": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        25
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo24"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo26": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        26
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo25"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo27": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        27
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo26"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo28": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        28
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo27"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo29": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        29
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo28"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo30": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        30
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo29"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo31": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        31
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo30"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo4": {
            "Fn::Equals": [
                {
                    "Ref": "NumSRRHosts"
                },
                4
            ]
        },
        "NumInstancesLessThanOrEqualTo5": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        5
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo4"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo6": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        6
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo5"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo7": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        7
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo6"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo8": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        8
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo7"
                }
            ]
        },
        "NumInstancesLessThanOrEqualTo9": {
            "Fn::Or": [
                {
                    "Fn::Equals": [
                        {
                            "Ref": "NumSRRHosts"
                        },
                        9
                    ]
                },
                {
                    "Condition": "NumInstancesLessThanOrEqualTo8"
                }
            ]
        },
        "SSLCertificateIdIsUndefined": {
            "Fn::Equals": [
                {
                    "Ref": "SSLCertificateId"
                },
                ""
            ]
        }
    },
    "Mappings": {
        "AWSAMIRegion": {
            "us-west-2": {
                "AMI": "ami-9b7f66e2"
            }
        }
    },
    "Outputs": {
        "ElasticLoadBalancerID": {
            "Description": "ElasticLoadBalancerID ID",
            "Value": {
                "Ref": "ElasticLoadBalancer"
            }
        }
    },
    "Parameters": {
        "AvailabilityZones": {
            "Description": "The availability zone in which to place the EC2 instance",
            "Type": "List<AWS::EC2::AvailabilityZone::Name>"
        },
        "BucketName": {
            "ConstraintDescription": "must be a valid S3 bucket name.",
            "Description": "The bucket to which StorReduce will store data",
            "Type": "String"
        },
        "DomainName": {
            "Description": "The Domain Name to be used to generate an SSL certificate (not required if SSLCertificateId exists)",
            "Type": "String"
        },
        "HostProfile": {
            "Description": "The host profile to associate with the StorReduce instance(s)",
            "Type": "String"
        },
        "HostRole": {
            "Description": "The host role to associate with the StorReduce instance(s) for pulling scripts",
            "Type": "String"
        },
        "InstanceType": {
            "AllowedValues": [
                "i3.xlarge",
                "i3.2xlarge",
                "i3.4xlarge",
                "i3.8xlarge",
                "i3.16xlarge"
            ],
            "ConstraintDescription": "must be a valid EC2 instance type.",
            "Default": "i3.4xlarge",
            "Description": "EC2 instance type",
            "Type": "String"
        },
        "KeyPairName": {
            "ConstraintDescription": "must be the name of an existing EC2 KeyPair.",
            "Description": "Name of an existing EC2 KeyPair to enable SSH access to the instances",
            "Type": "AWS::EC2::KeyPair::KeyName"
        },
        "LoadBalancerSecurityGroup": {
            "Description": "The security group associated with the load balancer",
            "Type": "AWS::EC2::SecurityGroup::Id"
        },
        "NumSRRHosts": {
            "Description": "The number of StorReduce hosts to configure",
            "MaxValue": 31,
            "MinValue": 3,
            "Type": "Number"
        },
        "PrivateSubnetsToSpan": {
            "Description": "The VPC private subnets to span",
            "Type": "List<AWS::EC2::Subnet::Id>"
        },
        "PublicSubnetsToSpan": {
            "Description": "The VPC public subnets to span",
            "Type": "List<AWS::EC2::Subnet::Id>"
        },
        "QSS3BucketName": {
            "AllowedPattern": "^[0-9a-zA-Z]+([0-9a-zA-Z-]*[0-9a-zA-Z])*$",
            "ConstraintDescription": "Quick Start bucket name can include numbers, lowercase letters, uppercase letters, and hyphens (-). It cannot start or end with a hyphen (-).",
            "Default": "gong-cf-templates",
            "Description": "S3 bucket name for the Quick Start assets. Quick Start bucket name can include numbers, lowercase letters, uppercase letters, and hyphens (-). It cannot start or end with a hyphen (-).",
            "Type": "String"
        },
        "QSS3KeyPrefix": {
            "AllowedPattern": "^[0-9a-zA-Z-/]*$",
            "ConstraintDescription": "Quick Start key prefix can include numbers, lowercase letters, uppercase letters, hyphens (-), and forward slash (/).",
            "Default": "",
            "Description": "S3 key prefix for the Quick Start assets. Quick Start key prefix can include numbers, lowercase letters, uppercase letters, hyphens (-), and forward slash (/).",
            "Type": "String"
        },
        "SSLCertificateId": {
            "Description": "The SSL Certificate ID to use for the load balancer",
            "Type": "String"
        },
        "SecurityGroupIds": {
            "Description": "The securitys group associated with the instance",
            "Type": "List<AWS::EC2::SecurityGroup::Id>"
        },
        "StorReduceLicense": {
            "ConstraintDescription": "must be a current and valid StorReduce license.",
            "Description": "A StorReduce license",
            "Type": "String"
        },
        "StorReducePassword": {
            "Description": "Password for the StorReduce admin root user",
            "NoEcho": true,
            "Type": "String"
        },
        "ValidationDomainName": {
            "Description": "The validation domain name to be used to validate domain ownership for an SSL certificate (not required if SSLCertificateId exists)",
            "Type": "String"
        }
    },
    "Resources": {
        "ElasticLoadBalancer": {
            "Properties": {
                "CrossZone": "true",
                "HealthCheck": {
                    "HealthyThreshold": "3",
                    "Interval": "30",
                    "Target": "HTTP:80/health_check",
                    "Timeout": "5",
                    "UnhealthyThreshold": "5"
                },
                "Listeners": [
                    {
                        "InstancePort": "80",
                        "InstanceProtocol": "TCP",
                        "LoadBalancerPort": "80",
                        "Protocol": "TCP"
                    },
                    {
                        "InstancePort": "443",
                        "InstanceProtocol": "SSL",
                        "LoadBalancerPort": "443",
                        "Protocol": "SSL",
                        "SSLCertificateId": {
                            "Fn::If": [
                                "SSLCertificateIdIsUndefined",
                                {
                                    "Ref": "StorReduceSSLCertificate"
                                },
                                {
                                    "Ref": "SSLCertificateId"
                                }
                            ]
                        }
                    }
                ],
                "SecurityGroups": [
                    {
                        "Ref": "LoadBalancerSecurityGroup"
                    }
                ],
                "Subnets": {
                    "Ref": "PublicSubnetsToSpan"
                }
            },
            "Type": "AWS::ElasticLoadBalancing::LoadBalancer"
        },
        "StorReduceInstance0": {
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "ElasticLoadBalancer",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "init-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/init-srr.sh \"",
                                            {
                                                "Ref": "BucketName"
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReduceLicense"
                                            },
                                            "' ",
                                            "'",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Fn::GetAtt": [
                                                    "ElasticLoadBalancer",
                                                    "DNSName"
                                                ]
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/init-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/init-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrBaseHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance0 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance0 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance1": {
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance1 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance1 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance10": {
            "Condition": "NumInstancesLessThanOrEqualTo11",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance10 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance10 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance11": {
            "Condition": "NumInstancesLessThanOrEqualTo12",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "2",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "2",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance11 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance11 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance12": {
            "Condition": "NumInstancesLessThanOrEqualTo13",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance12 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance12 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance13": {
            "Condition": "NumInstancesLessThanOrEqualTo14",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance13 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance13 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance14": {
            "Condition": "NumInstancesLessThanOrEqualTo15",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "2",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "2",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance14 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance14 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance15": {
            "Condition": "NumInstancesLessThanOrEqualTo16",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance15 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance15 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance16": {
            "Condition": "NumInstancesLessThanOrEqualTo17",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance16 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance16 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance17": {
            "Condition": "NumInstancesLessThanOrEqualTo18",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "2",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "2",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance17 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance17 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance18": {
            "Condition": "NumInstancesLessThanOrEqualTo19",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance18 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance18 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance19": {
            "Condition": "NumInstancesLessThanOrEqualTo20",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance19 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance19 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance2": {
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "2",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "2",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance2 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance2 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance20": {
            "Condition": "NumInstancesLessThanOrEqualTo21",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "2",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "2",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance20 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance20 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance21": {
            "Condition": "NumInstancesLessThanOrEqualTo22",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance21 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance21 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance22": {
            "Condition": "NumInstancesLessThanOrEqualTo23",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance22 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance22 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance23": {
            "Condition": "NumInstancesLessThanOrEqualTo24",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "2",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "2",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance23 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance23 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance24": {
            "Condition": "NumInstancesLessThanOrEqualTo25",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance24 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance24 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance25": {
            "Condition": "NumInstancesLessThanOrEqualTo26",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance25 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance25 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance26": {
            "Condition": "NumInstancesLessThanOrEqualTo27",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "2",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "2",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance26 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance26 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance27": {
            "Condition": "NumInstancesLessThanOrEqualTo28",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance27 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance27 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance28": {
            "Condition": "NumInstancesLessThanOrEqualTo29",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance28 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance28 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance29": {
            "Condition": "NumInstancesLessThanOrEqualTo30",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "2",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "2",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance29 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance29 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance3": {
            "Condition": "NumInstancesLessThanOrEqualTo4",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance3 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance3 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance30": {
            "Condition": "NumInstancesLessThanOrEqualTo31",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance30 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance30 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance4": {
            "Condition": "NumInstancesLessThanOrEqualTo5",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance4 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance4 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance5": {
            "Condition": "NumInstancesLessThanOrEqualTo6",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "2",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "2",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance5 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance5 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance6": {
            "Condition": "NumInstancesLessThanOrEqualTo7",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance6 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance6 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance7": {
            "Condition": "NumInstancesLessThanOrEqualTo8",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "1",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance7 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance7 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance8": {
            "Condition": "NumInstancesLessThanOrEqualTo9",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "2",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "2",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance8 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance8 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceInstance9": {
            "Condition": "NumInstancesLessThanOrEqualTo10",
            "CreationPolicy": {
                "ResourceSignal": {
                    "Timeout": "PT15M"
                }
            },
            "DependsOn": "StorReduceInstance0",
            "Metadata": {
                "AWS::CloudFormation::Authentication": {
                    "S3AccessCreds": {
                        "buckets": [
                            {
                                "Ref": "QSS3BucketName"
                            }
                        ],
                        "roleName": {
                            "Ref": "HostRole"
                        },
                        "type": "S3"
                    }
                },
                "AWS::CloudFormation::Init": {
                    "config": {
                        "commands": {
                            "connect-srr": {
                                "command": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "/home/ec2-user/connect-srr.sh \"",
                                            {
                                                "Fn::GetAtt": [
                                                    "StorReduceInstance0",
                                                    "PrivateDnsName"
                                                ]
                                            },
                                            "\" '",
                                            {
                                                "Ref": "StorReducePassword"
                                            },
                                            "' ",
                                            "\"",
                                            {
                                                "Ref": "ElasticLoadBalancer"
                                            },
                                            "\" ",
                                            "\"",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            "\" "
                                        ]
                                    ]
                                }
                            }
                        },
                        "files": {
                            "/home/ec2-user/connect-srr.sh": {
                                "group": "root",
                                "mode": "000550",
                                "owner": "root",
                                "source": {
                                    "Fn::Sub": [
                                        "https://${QSS3BucketName}.${QSS3Region}.amazonaws.com/${QSS3KeyPrefix}scripts/connect-srr.sh",
                                        {
                                            "QSS3Region": {
                                                "Fn::If": [
                                                    "GovCloudCondition",
                                                    "s3-us-gov-west-1",
                                                    "s3"
                                                ]
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "Properties": {
                "AvailabilityZone": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "AvailabilityZones"
                        }
                    ]
                },
                "IamInstanceProfile": {
                    "Ref": "HostProfile"
                },
                "ImageId": {
                    "Fn::FindInMap": [
                        "AWSAMIRegion",
                        {
                            "Ref": "AWS::Region"
                        },
                        "AMI"
                    ]
                },
                "InstanceType": {
                    "Ref": "InstanceType"
                },
                "KeyName": {
                    "Ref": "KeyPairName"
                },
                "SecurityGroupIds": {
                    "Ref": "SecurityGroupIds"
                },
                "SubnetId": {
                    "Fn::Select": [
                        "0",
                        {
                            "Ref": "PrivateSubnetsToSpan"
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": "SrrHost"
                    }
                ],
                "UserData": {
                    "Fn::Base64": {
                        "Fn::Join": [
                            "",
                            [
                                "\n    #!/bin/bash -xe\n    /opt/aws/bin/cfn-init -v --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                " --resource StorReduceInstance9 --region ",
                                {
                                    "Ref": "AWS::Region"
                                },
                                "\n",
                                "/opt/aws/bin/cfn-signal -e $? --stack ",
                                {
                                    "Ref": "AWS::StackName"
                                },
                                "    --resource StorReduceInstance9 --region ",
                                {
                                    "Ref": "AWS::Region"
                                }
                            ]
                        ]
                    }
                }
            },
            "Type": "AWS::EC2::Instance"
        },
        "StorReduceSSLCertificate": {
            "Condition": "SSLCertificateIdIsUndefined",
            "Properties": {
                "DomainName": {
                    "Ref": "DomainName"
                },
                "DomainValidationOptions": [
                    {
                        "DomainName": {
                            "Ref": "DomainName"
                        },
                        "ValidationDomain": {
                            "Ref": "ValidationDomainName"
                        }
                    }
                ]
            },
            "Type": "AWS::CertificateManager::Certificate"
        }
    }
}
